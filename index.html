<script>
// ==========================================
// üåç LISTA DE PA√çSES (INTEGRIDADE MANTIDA)
// ==========================================
const ALL_COUNTRIES = [
    "Afeganist√£o","√Åfrica do Sul","Alb√¢nia","Alemanha","Andorra","Angola","Ant√≠gua e Barbuda",
    "Ar√°bia Saudita","Arg√©lia","Argentina","Arm√™nia","Austr√°lia","√Åustria","Azerbaij√£o",
    "Bahamas","Bangladesh","Barbados","Barein","B√©lgica","Belize","Benim","Bielorr√∫ssia",
    "Bol√≠via","B√≥snia","Botswana","Brasil","Brunei","Bulg√°ria","Burkina Faso","Burundi",
    "But√£o","Cabo Verde","Camar√µes","Camboja","Canad√°","Catar","Cazaquist√£o","Chade",
    "Chile","China","Chipre","Col√¥mbia","Comores","Congo","Coreia do Norte","Coreia do Sul",
    "Costa Rica","Costa do Marfim","Cro√°cia","Cuba","Dinamarca","Djibouti","Dominica",
    "Egito","El Salvador","Emirados √Årabes","Equador","Eritreia","Eslov√°quia","Eslov√™nia",
    "Espanha","Estados Unidos","Est√¥nia","Eti√≥pia","Fiji","Filipinas","Finl√¢ndia","Fran√ßa",
    "Gab√£o","G√¢mbia","Gana","Ge√≥rgia","Granada","Gr√©cia","Guatemala","Guiana","Guin√©",
    "Guin√©-Bissau","Guin√© Equatorial","Haiti","Holanda","Honduras","Hungria","I√™men","√çndia",
    "Indon√©sia","Ir√£","Iraque","Irlanda","Isl√¢ndia","Israel","It√°lia","Jamaica","Jap√£o",
    "Jord√¢nia","Kiribati","Kuwait","Laos","Lesoto","Let√¥nia","L√≠bano","Lib√©ria","L√≠bia",
    "Liechtenstein","Litu√¢nia","Luxemburgo","Maced√¥nia","Madagascar","Mal√°sia","Malawi",
    "Maldivas","Mali","Malta","Marrocos","Maur√≠cio","Maurit√¢nia","M√©xico","Mianmar",
    "Micron√©sia","Mo√ßambique","Mold√°via","M√¥naco","Mong√≥lia","Montenegro","Nam√≠bia","Nauru",
    "Nepal","Nicar√°gua","N√≠ger","Nig√©ria","Noruega","Nova Zel√¢ndia","Om√£","Palau","Panam√°",
    "Papua Nova Guin√©","Paquist√£o","Paraguai","Peru","Pol√¥nia","Portugal","Qu√™nia",
    "Quirguist√£o","Reino Unido","Rep√∫blica Centro-Africana","Rep√∫blica Dominicana",
    "Rep√∫blica Tcheca","Rom√™nia","Ruanda","R√∫ssia","Samoa","San Marino","Santa L√∫cia",
    "S√£o Crist√≥v√£o","S√£o Tom√©","S√£o Vicente","Senegal","Serra Leoa","S√©rvia","Singapura",
    "S√≠ria","Som√°lia","Sri Lanka","Suazil√¢ndia","Sud√£o","Sud√£o do Sul","Su√©cia","Su√≠√ßa",
    "Suriname","Tail√¢ndia","Tajiquist√£o","Tanz√¢nia","Timor-Leste","Togo","Tonga",
    "Trinidad e Tobago","Tun√≠sia","Turcomenist√£o","Turquia","Tuvalu","Ucr√¢nia","Uganda",
    "Uruguai","Uzbequist√£o","Vanuatu","Vaticano","Venezuela","Vietn√£","Z√¢mbia","Zimb√°bue"
];

// ==========================================
// ü™ñ GERADOR DE INTELIG√äNCIA MILITAR AVAN√áADO
// ==========================================
function gerarPoderPais(nome) {
    const seed = nome.length;
    const doutrinas = ["Guerra Assim√©trica", "Blitzkrieg Moderna", "Defesa Territorial", "Supremacia A√©rea", "Guerra Eletr√¥nica"];
    
    return {
        soldados: Math.floor(Math.random() * 1200000 + (seed * 5000)),
        tanques: Math.floor(Math.random() * 8000 + (seed * 20)),
        avioes: Math.floor(Math.random() * 2500 + (seed * 15)),
        naval: Math.floor(Math.random() * 400 + (seed * 2)),
        nuclear: (["R√∫ssia", "Estados Unidos", "China", "Fran√ßa", "Reino Unido", "√çndia", "Paquist√£o", "Coreia do Norte", "Israel"].includes(nome)) ? Math.floor(Math.random() * 5000 + 100) : 0,
        treino: Math.floor(Math.random() * 40 + 60), // N√≠vel 60-100
        tecnologia: Math.floor(Math.random() * 50 + 50), // N√≠vel 50-100
        moral: Math.floor(Math.random() * 100),
        doutrina: doutrinas[Math.floor(Math.random() * doutrinas.length)],
        pontoForte: (seed % 2 === 0) ? "Log√≠stica Inquebr√°vel" : "For√ßas Especiais Elite"
    };
}

// ==========================================
// ‚öîÔ∏è MOTOR DE ATRI√á√ÉO E C√ÅLCULO DE GUERRA
// ==========================================
function calcularPoder(p, isAttacker) {
    // Pesos Estrat√©gicos
    let forcaBruta = (p.soldados * 0.1) + (p.tanques * 10) + (p.avioes * 25) + (p.naval * 15);
    let multiplicadorTecno = 1 + (p.tecnologia / 100);
    let multiplicadorElite = 1 + (p.treino / 100);
    
    let poderFinal = forcaBruta * multiplicadorTecno * multiplicadorElite;

    // Fator Doutrina
    if (p.doutrina === "Supremacia A√©rea") poderFinal *= 1.2;
    
    // Penalidade de Invasor vs B√¥nus de Defensor
    // Historicamente, invadir exige 3x mais for√ßa.
    return isAttacker ? Math.floor(poderFinal * 0.8) : Math.floor(poderFinal * 1.3);
}

// ==========================================
// üåç INICIALIZA√á√ÉO DE INTERFACE
// ==========================================
const atkSel = document.getElementById("atk-sel");
const defSel = document.getElementById("def-sel");

ALL_COUNTRIES.sort().forEach(p => {
    atkSel.innerHTML += `<option value="${p}">${p}</option>`;
    defSel.innerHTML += `<option value="${p}">${p}</option>`;
});

// ==========================================
// üß† SIMULA√á√ÉO DE CONFLITO CINEMATOGR√ÅFICO
// ==========================================
function triggerWar() {
    const atkName = atkSel.value;
    const defName = defSel.value;

    if (atkName === defName) {
        addLog("<span style='color:yellow'>ERRO: Um pa√≠s n√£o pode invadir a si mesmo.</span>");
        return;
    }

    const atk = gerarPoderPais(atkName);
    const def = gerarPoderPais(defName);

    const atkPwr = calcularPoder(atk, true);
    const defPwr = calcularPoder(def, false);

    // Efeitos Visuais
    document.getElementById("defcon-status").innerText = "DEFCON 1";
    document.getElementById("defcon-status").style.color = "#ff003c";
    gsap.to(camera.position, { z: 7, duration: 1.5, ease: "expo.inOut" });
    
    addLog(`<br><span style="color:#ff003c">‚ö° INICIANDO OPERA√á√ÉO: ${atkName} -> ${defName}</span>`);
    addLog(`Doutrina Atacante: ${atk.doutrina} | Ponto Forte Defensor: ${def.pontoForte}`);
    
    setTimeout(() => {
        addLog(`--- COMPARATIVO DE FOR√áAS ---`);
        addLog(`${atkName}: ${atk.soldados.toLocaleString()} tropas | Poder: ${atkPwr}`);
        addLog(`${defName}: ${def.soldados.toLocaleString()} tropas | Poder: ${defPwr}`);
        
        const diff = Math.abs(atkPwr - defPwr);
        let msgFinal = "";

        if (atkPwr > defPwr) {
            msgFinal = `<span style="color:#00f3ff">üèÜ VITORIA TOTAL: ${atkName} ocupou o territ√≥rio de ${defName}.</span>`;
            if (def.nuclear > 0) msgFinal += " <br>‚ò¢Ô∏è ALERTA: Retalia√ß√£o nuclear detectada.";
        } else {
            msgFinal = `<span style="color:#ff003c">üõ°Ô∏è DERROTA: O invasor ${atkName} foi repelido por ${defName}.</span>`;
        }

        addLog(msgFinal);
        addLog(`Baixas estimadas: ${Math.floor(diff / 100).toLocaleString()} unidades.`);
        
        // Retornar c√¢mera ap√≥s simula√ß√£o
        gsap.to(camera.position, { z: 11, duration: 3, delay: 2 });
    }, 1000);
}

function addLog(msg) {
    const el = document.getElementById("intel-logs");
    const div = document.createElement("div");
    div.style.marginBottom = "8px";
    div.style.borderLeft = "2px solid #00f3ff";
    div.style.paddingLeft = "10px";
    div.innerHTML = `<span style="opacity:0.5">[${new Date().toLocaleTimeString()}]</span> ${msg}`;
    el.prepend(div);
}
</script>
